---
title: "Alabama Tornado Analysis"
author: "Owen Widdis"
date: "2025-12-01"
output:
  html_document: default
  pdf_document: default
---
# Background

In 2008, while on a family trip to the Wisconsin Dells, we were forced to take shelter in a roadside ditch to escape an oncoming tornado. Thankfully, we emerged unharmed, but the experience left a lasting impression on me. As I grew older, that encounter sparked an interest in tornadoes and their effects on infrastructure, the environment, and the lives of those in their path. 

# Research Question

With growing concern about climate change and its potential impact on storm intensity, I became interested in exploring how shifts in atmospheric conditions have influenced tornadoes. Specifically, I wanted to investigate whether or not there is an affect on inflation-adjusted damage costs from tornadoes in Alabama from 1950 - 2025.

### Intensity Variables

To measure the intensity of a given storm, I considered several variables. In 1971, Ted Fujita developed the Fujita Scale to distinguish between weak and strong tornadoes. This scale was quickly adopted by the meteorological community; however, long-term use revealed several inconsistencies and inaccuracies in storm ratings. Researchers at Texas Tech University proposed the Enhanced Fujita (EF) Scale in 2004, building upon the original framework. The EF Scale uses damage indicators and degrees of damage to estimate wind speeds, which are then used to assign a storm’s rating. The National Weather Service officially adopted the EF Scale in 2007.

It is important to note that the dataset used for this project (the Storm Events Database from the National Oceanic and Atmospheric Administration) includes both F and EF Scale ratings (F Scale: 1950–February 1, 2007; EF Scale: February 1, 2007–2025). Tornadoes that occurred prior to the development of the Fujita Scale in 1971 were rated retroactively using newspaper reports, eyewitness accounts, and other available documentation describing storm impacts.

Second, I examined damage estimates from each storm across two variables: property damage and crop damage. To account for inflation, I used the quantmod library to access Federal Reserve Consumer Price Index (CPI) data for each month from 1950 to 2025 and adjusted all damage estimates accordingly.

### Focus Area

I selected Alabama as my focus region for several key reasons. First and foremost, Alabama experiences a high frequency of tornadic activity. Second, the state has been affected by numerous high-impact and costly tornado events, largely due to its relatively dense human and built infrastructure compared to other tornado-prone regions such as Kansas and Oklahoma, which are more predominantly rural and agricultural. As a result, Alabama represents a compelling case study, as it encompasses a mix of agricultural land use and concentrated population centers, allowing for an examination of tornado impacts across varied infrastructure types.

# Methods

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(dplyr)
library(ggplot2)
library(quantmod)
library(scales)
library(ggplot2)
library(viridis)  # for nice color scales

options(scipen = 999)

```

### Load data 

```{r}
# Load CSV
tornado_df <- read_csv("C:/Users/walke/Documents/umich/courses/SI544/final_proj/tornado_analysis/merged/mega_tornado_filtered.csv")

# Convert numeric columns
numeric_cols <- c(
  "TOR_LENGTH", "TOR_WIDTH",
  "DEATHS_DIRECT", "INJURIES_DIRECT",
  "DAMAGE_PROPERTY_NUM", "DAMAGE_CROPS_NUM"
)

tornado_df <- tornado_df %>%
  mutate(across(all_of(numeric_cols), ~as.numeric(.)))

# Convert dates + create DATE column for joining
tornado_df <- tornado_df %>%
  mutate(
    BEGIN_DATE = mdy(BEGIN_DATE),
    END_DATE   = mdy(END_DATE),
    DATE       = as.Date(BEGIN_DATE),
    YEAR       = year(BEGIN_DATE)
  )

# rm columns
tornado_df <- tornado_df %>%
  select(
    -EVENT_ID,
    -CZ_NAME_STR,
    -EVENT_TYPE
  )
```
### Load CPI data and join it with Tornado dataframe, then cleanup dataframe.

```{r}

# Download CPI from FRED (monthly)
getSymbols("CPIAUCSL", src = "FRED")

# Convert to tibble
cpi_df <- CPIAUCSL %>%
  data.frame(date = index(.)) %>%
  as_tibble() %>%
  rename(CPIAUCSL = CPIAUCSL)

# 2025 CPI target
target_cpi <- 324.368

# Inflation adjustment factor
cpi_df <- cpi_df %>%
  mutate(adj_factor = target_cpi / CPIAUCSL)

tornado_df <- tornado_df %>%
  mutate(
    DATE = as.Date(BEGIN_DATE),
    DATE_MONTH = floor_date(DATE, unit = "month")
  )

# Left join by DATE (tornado) and date (CPI)
tornado_df <- tornado_df %>%
  left_join(cpi_df, by = c("DATE_MONTH" = "date"))

tornado_df <- tornado_df %>%
  mutate(
    DAMAGE_PROPERTY_2025 = DAMAGE_PROPERTY_NUM * adj_factor,
    DAMAGE_CROPS_2025    = DAMAGE_CROPS_NUM * adj_factor,
    DAMAGE_PROPERTY_2025_DOL = dollar(DAMAGE_PROPERTY_2025),
    DAMAGE_CROPS_2025_DOL    = dollar(DAMAGE_CROPS_2025)
  )

# Clean tornado dataset with uppercase column names
tornado_clean <- tornado_df %>%
  # Keep only relevant columns (uppercase)
  select(
    DATE, YEAR,
    BEGIN_DATE, END_DATE,
    BEGIN_LAT, BEGIN_LON,
    END_LAT, END_LON, TOR_F_SCALE,
    TOR_LENGTH, TOR_WIDTH,
    DEATHS_DIRECT, INJURIES_DIRECT,
    DAMAGE_PROPERTY_NUM, DAMAGE_CROPS_NUM,
    DAMAGE_PROPERTY_2025, DAMAGE_CROPS_2025
  ) %>%
  # Rename columns to uppercase + more readable
  rename(
    START_DATE = BEGIN_DATE,
    END_DATE   = END_DATE,
    START_LAT  = BEGIN_LAT,
    START_LON  = BEGIN_LON,
    END_LAT    = END_LAT,
    END_LON    = END_LON,
    TORNADO_LENGTH = TOR_LENGTH,
    TORNADO_WIDTH  = TOR_WIDTH,
    DEATHS  = DEATHS_DIRECT,
    INJURIES = INJURIES_DIRECT,
    DAMAGE_PROPERTY = DAMAGE_PROPERTY_NUM,
    DAMAGE_CROPS    = DAMAGE_CROPS_NUM,
    DAMAGE_PROPERTY_2025_USD = DAMAGE_PROPERTY_2025,
    DAMAGE_CROPS_2025_USD    = DAMAGE_CROPS_2025
  ) %>%
  # Add formatted dollar versions for display
  mutate(
    DAMAGE_PROPERTY_2025_DOL = dollar(DAMAGE_PROPERTY_2025_USD),
    DAMAGE_CROPS_2025_DOL    = dollar(DAMAGE_CROPS_2025_USD)
  ) %>%
  # Sort by DATE ascending
  arrange(DATE)
tornado_clean <- tornado_clean %>%
  mutate(
    TOR_F_SCALE_NUM = as.numeric(str_extract(TOR_F_SCALE, "\\d+"))
  )


# Preview
tail(tornado_clean, 1000)

```

### Exploratory Data Analysis

```{r}
annual_damage <- tornado_clean %>%
  group_by(YEAR) %>%
  summarise(
    total_property_damage = sum(DAMAGE_PROPERTY_2025_USD, na.rm = TRUE),
    total_crop_damage     = sum(DAMAGE_CROPS_2025_USD, na.rm = TRUE),
    tornado_count         = n(),
    mean_intensity        = mean(TOR_F_SCALE, na.rm = TRUE)
  )

ggplot(annual_damage, aes(x = YEAR, y = total_property_damage)) +
  geom_line() +
  scale_y_continuous(labels = dollar) +
  labs(
    title = "Annual Inflation-Adjusted Property Damage from Tornadoes in Alabama",
    x = "Year",
    y = "Property Damage (2025 USD)"
  ) +
  theme_minimal()

```


```{r}

df_corr_price_intensity <- tornado_clean %>%
  select(
    DAMAGE_PROPERTY_2025_USD,
    DAMAGE_CROPS_2025_USD,
    TORNADO_LENGTH,
    TORNADO_WIDTH
  ) %>%
  drop_na()

summary(df_corr_price_intensity)


cor.test(
  df_corr_price_intensity$DAMAGE_PROPERTY_2025_USD,
  df_corr_price_intensity$TORNADO_LENGTH,
  method = "spearman"
)

cor.test(
  df_corr_price_intensity$DAMAGE_PROPERTY_2025_USD,
  df_corr_price_intensity$TORNADO_WIDTH,
  method = "spearman"
)

cor(
  df_corr_price_intensity %>%
    select(
      DAMAGE_PROPERTY_2025_USD,
      TORNADO_LENGTH,
      TORNADO_WIDTH
    ),
  method = "spearman",
  use = "complete.obs"
)

ggplot(df_corr_price_intensity,
       aes(TORNADO_WIDTH, DAMAGE_PROPERTY_2025_USD)) +
  geom_point(alpha = 0.3) +
  scale_y_log10() +
  labs(
    title = "Inflation-Adjusted Property Damage vs Tornado Width",
    x = "Tornado Width",
    y = "Property Damage (2025 USD, log scale)"
  )


```



```{r}

# regression
df_reg <- tornado_clean %>%
  select(
    DAMAGE_PROPERTY_2025_USD,
    TORNADO_LENGTH,
    TORNADO_WIDTH,
    YEAR
  ) %>%
  filter(
    !is.na(DAMAGE_PROPERTY_2025_USD),
    DAMAGE_PROPERTY_2025_USD > 0,
    !is.na(TORNADO_LENGTH),
    !is.na(TORNADO_WIDTH)
  ) %>%
  mutate(
    LOG_DAMAGE = log(DAMAGE_PROPERTY_2025_USD),
    LENGTH_Z = as.numeric(scale(TORNADO_LENGTH)),
    WIDTH_Z  = as.numeric(scale(TORNADO_WIDTH))
  )
model_1 <- lm(
  LOG_DAMAGE ~ LENGTH_Z + WIDTH_Z,
  data = df_reg
)

summary(model_1)

# Make the combined plot
ggplot(df_reg, aes(x = TORNADO_LENGTH, y = LOG_DAMAGE, color = TORNADO_WIDTH)) +
  geom_point(alpha = 0.4) +                             # scatter points
  geom_smooth(method = "lm", se = TRUE, color = "black") +  # regression line
  scale_color_viridis(option = "plasma", trans = "log", direction = -1) +  # log color scale for width
  labs(
    title = "Inflation-Adjusted Property Damage by Tornado Length and Width",
    subtitle = "Point color indicates tornado width; line shows regression trend",
    x = "Tornado Length (miles)",
    y = "Log(Property Damage in 2025 USD)",
    color = "Tornado Width (yards)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold"),
    plot.subtitle = element_text(face = "italic"),
    legend.position = "right" 
  ) + xlim(0, 50)



```